<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Instafatih Chat</title>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>

<style>
body{
  margin:0;
  background:#e5ddd5;
  font-family:Arial;
}

.header{
  background:#075E54;
  color:white;
  padding:15px;
  font-size:18px;
  font-weight:bold;
  text-align:center;
}

.chat{
  height:80vh;
  overflow-y:auto;
  padding:15px;
}

.message{
  max-width:70%;
  padding:10px;
  margin:5px 0;
  border-radius:10px;
  word-wrap:break-word;
}

.me{
  background:#dcf8c6;
  margin-left:auto;
}

.other{
  background:white;
  margin-right:auto;
}

.input-area{
  display:flex;
  padding:10px;
  background:#f0f0f0;
}

input{
  flex:1;
  padding:10px;
  border-radius:20px;
  border:none;
  outline:none;
}

button{
  margin-left:10px;
  padding:10px 20px;
  border:none;
  border-radius:20px;
  background:#075E54;
  color:white;
  cursor:pointer;
}
</style>
</head>
<body>

<div class="header">Instafatih Grup</div>

<div class="chat" id="chat"></div>

<div class="input-area">
  <input type="text" id="messageInput" placeholder="Mesaj yaz...">
  <button onclick="sendMessage()">GÃ¶nder</button>
</div>

<script>
const firebaseConfig = {
  apiKey: "BURAYA",
  authDomain: "BURAYA",
  projectId: "BURAYA",
};

firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const auth = firebase.auth();

let currentUser;

auth.signInAnonymously().then(user=>{
  currentUser = user.user.uid;
});

function sendMessage(){
  const text = document.getElementById("messageInput").value;
  if(text.trim() === "") return;

  db.collection("messages").add({
    text:text,
    sender:currentUser,
    time:Date.now()
  });

  document.getElementById("messageInput").value="";
}

db.collection("messages")
.orderBy("time")
.onSnapshot(snapshot=>{
  const chat = document.getElementById("chat");
  chat.innerHTML="";

  snapshot.forEach(doc=>{
    const data = doc.data();
    const div = document.createElement("div");
    div.classList.add("message");

    if(data.sender === currentUser){
      div.classList.add("me");
    }else{
      div.classList.add("other");
    }

    div.innerText = data.text;
    chat.appendChild(div);
  });

  chat.scrollTop = chat.scrollHeight;
});
</script>

</body>
</html>