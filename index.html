<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Chat</title>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial;
  background:#fafafa;
}
#app{
  max-width:420px;
  margin:auto;
  height:100vh;
  display:flex;
  flex-direction:column;
  background:white;
  border-left:1px solid #dbdbdb;
  border-right:1px solid #dbdbdb;
}
header{
  padding:12px;
  text-align:center;
  font-weight:600;
  border-bottom:1px solid #dbdbdb;
}
#messages{
  flex:1;
  padding:10px;
  overflow-y:auto;
  background:#fafafa;
}
.msg{
  max-width:75%;
  padding:8px 12px;
  border-radius:18px;
  margin-bottom:8px;
  font-size:14px;
}
.me{
  background:#3797f0;
  color:white;
  margin-left:auto;
}
.other{
  background:#e4e6eb;
}
.meta{
  font-size:11px;
  opacity:.6;
  margin-top:4px;
}
.actions{
  font-size:12px;
  margin-top:4px;
}
.actions span{
  cursor:pointer;
  margin-right:8px;
}
footer{
  display:flex;
  padding:8px;
  border-top:1px solid #dbdbdb;
}
footer input{
  flex:1;
  border:1px solid #dbdbdb;
  border-radius:20px;
  padding:8px 12px;
}
footer button{
  background:none;
  border:none;
  color:#3797f0;
  font-weight:600;
  margin-left:8px;
  cursor:pointer;
}
</style>
</head>

<body>
<div id="app">
  <header>Grup Sohbet</header>
  <div id="messages"></div>
  <footer>
    <input id="text" placeholder="Mesaj yaz...">
    <button onclick="send()">G√∂nder</button>
  </footer>
</div>

<!-- Firebase v8 -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
// üî¥ KENDƒ∞ FIREBASE Bƒ∞LGƒ∞LERƒ∞Nƒ∞ YAZ
var firebaseConfig = {
  apiKey: "API_KEY",
  authDomain: "PROJECT_ID.firebaseapp.com",
  databaseURL: "https://PROJECT_ID-default-rtdb.firebaseio.com",
  projectId: "PROJECT_ID"
};
firebase.initializeApp(firebaseConfig);

var db = firebase.database();
var ref = db.ref("messages");

var username = "User" + Math.floor(Math.random()*9000+1000);

// MESAJLARI Dƒ∞NLE
ref.limitToLast(100).on("child_added", snap=>{
  draw(snap.key, snap.val());
});

// MESAJ G√ñNDER
function send(){
  var t = text.value.trim();
  if(!t) return;
  ref.push({
    user: username,
    text: t,
    likes: 0,
    seen: false,
    time: Date.now()
  });
  text.value="";
}

// EKRANA √áƒ∞Z
function draw(id,m){
  var d = document.createElement("div");
  d.className = "msg " + (m.user===username?"me":"other");
  d.id = id;
  d.innerHTML = `
    <div>${m.text}</div>
    <div class="actions">
      <span onclick="like('${id}')">‚ù§Ô∏è ${m.likes}</span>
      ${m.user===username?`<span onclick="del('${id}')">Sil</span>`:""}
    </div>
    <div class="meta">${m.seen?"G√∂r√ºld√º":""}</div>
  `;
  messages.appendChild(d);
  messages.scrollTop = messages.scrollHeight;

  // okundu
  if(m.user!==username && !m.seen){
    ref.child(id).update({seen:true});
  }
}

// BEƒûENƒ∞
function like(id){
  ref.child(id).once("value",s=>{
    ref.child(id).update({likes:(s.val().likes||0)+1});
  });
}

// Sƒ∞L
function del(id){
  ref.child(id).remove();
  document.getElementById(id)?.remove();
}
</script>
</body>
</html>