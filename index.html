<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>GerÃ§ek ZamanlÄ± Grup Chat</title>
  <style>
    body { font-family: Arial; background:#111; color:#fff; }
    #chat { max-width:500px; margin:20px auto; }
    #messages { border:1px solid #444; height:300px; overflow-y:auto; padding:10px; }
    input, button { width:100%; margin-top:5px; padding:10px; }
    .msg { margin-bottom:6px; }
  </style>
</head>
<body>

<div id="chat">
  <input id="name" placeholder="AdÄ±n" />
  <div id="messages"></div>
  <input id="text" placeholder="Mesaj yaz..." />
  <button id="send">GÃ¶nder</button>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

  // ðŸ”´ BURAYI KENDÄ° FIREBASE BÄ°LGÄ°LERÄ°NLE DEÄžÄ°ÅžTÄ°R
  const firebaseConfig = {
    apiKey: "API_KEY",
    authDomain: "PROJECT_ID.firebaseapp.com",
    projectId: "PROJECT_ID",
    storageBucket: "PROJECT_ID.appspot.com",
    messagingSenderId: "SENDER_ID",
    appId: "APP_ID"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const messagesDiv = document.getElementById("messages");
  const sendBtn = document.getElementById("send");

  const chatRef = collection(db, "odalar", "genel", "mesajlar");

  // ðŸ”´ GERÃ‡EK ZAMANLI DÄ°NLEME
  onSnapshot(
    query(chatRef, orderBy("createdAt")),
    (snapshot) => {
      messagesDiv.innerHTML = "";
      snapshot.forEach(doc => {
        const m = doc.data();
        const div = document.createElement("div");
        div.className = "msg";
        div.textContent = m.name + ": " + m.text;
        messagesDiv.appendChild(div);
      });
      messagesDiv.scrollTop = messagesDiv.scrollHeight;
    }
  );

  // ðŸ”´ MESAJ GÃ–NDERME
  sendBtn.onclick = async () => {
    const name = document.getElementById("name").value;
    const text = document.getElementById("text").value;
    if (!name || !text) return;

    await addDoc(chatRef, {
      name,
      text,
      createdAt: serverTimestamp()
    });

    document.getElementById("text").value = "";
  };
</script>

</body>
</html>