<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Instafatih - Stories</title>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js"></script>

<style>
body{
  background:#fafafa;
  font-family:Arial;
  margin:0;
}

.header{
  background:linear-gradient(45deg,#f09433,#e6683c,#dc2743,#cc2366,#bc1888);
  color:white;
  padding:15px;
  font-size:20px;
  font-weight:bold;
  text-align:center;
}

.story-upload{
  padding:15px;
  text-align:center;
}

button{
  padding:10px 20px;
  border:none;
  border-radius:20px;
  background:#0095f6;
  color:white;
  font-weight:bold;
  cursor:pointer;
}

.stories{
  display:flex;
  gap:15px;
  overflow-x:auto;
  padding:15px;
}

.story{
  width:90px;
  text-align:center;
}

.story img{
  width:80px;
  height:80px;
  border-radius:50%;
  border:3px solid #e1306c;
  object-fit:cover;
}
</style>
</head>

<body>

<div class="header">Instafatih Hikayeler</div>

<div class="story-upload">
  <input type="file" id="fileInput">
  <br><br>
  <button onclick="uploadStory()">Hikaye Yükle</button>
</div>

<div class="stories" id="stories"></div>

<script>
const firebaseConfig = {
  apiKey: "BURAYA SENİN API KEY",
  authDomain: "BURAYA",
  projectId: "BURAYA",
  storageBucket: "BURAYA",
  messagingSenderId: "BURAYA",
  appId: "BURAYA"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const storage = firebase.storage();

auth.signInAnonymously();

function uploadStory(){
  const file = document.getElementById("fileInput").files[0];
  if(!file) return alert("Foto seç");

  const ref = storage.ref("stories/" + Date.now());
  ref.put(file).then(snapshot=>{
    snapshot.ref.getDownloadURL().then(url=>{
      db.collection("stories").add({
        image:url,
        time:Date.now()
      });
      alert("Hikaye yüklendi!");
    });
  });
}

db.collection("stories")
.orderBy("time","desc")
.onSnapshot(snapshot=>{
  document.getElementById("stories").innerHTML="";
  snapshot.forEach(doc=>{
    const data = doc.data();
    document.getElementById("stories").innerHTML += `
      <div class="story">
        <img src="${data.image}">
      </div>
    `;
  });
});
</script>

</body>
</html>