<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>InstaFatih Chat</title>
<style>
body { background:#000; color:#fff; font-family:Arial; margin:0; }
#login, #chat { padding:15px; }
input, button { width:100%; padding:10px; margin:5px 0; }
button { background:#1da1f2; color:#fff; border:none; }
#messages { height:60vh; overflow-y:auto; border:1px solid #333; padding:10px; }
.msg { margin:5px 0; }
.me { text-align:right; color:#1da1f2; }
</style>
</head>
<body>

<div id="login">
  <input id="username" placeholder="Kullanıcı adın">
  <button onclick="login()">Giriş</button>
</div>

<div id="chat" style="display:none;">
  <div id="messages"></div>
  <input id="text" placeholder="Mesaj yaz">
  <button onclick="send()">Gönder</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "API_KEYİN",
  authDomain: "DOMAIN",
  projectId: "PROJECT_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

let user = "";

window.login = () => {
  user = document.getElementById("username").value;
  if (!user) return alert("İsim yaz");
  document.getElementById("login").style.display = "none";
  document.getElementById("chat").style.display = "block";
  listen();
};

window.send = async () => {
  const text = document.getElementById("text").value;
  if (!text) return;
  await addDoc(collection(db, "mesajlar"), {
    gonderen: user,
    metin: text,
    zaman: Date.now()
  });
  document.getElementById("text").value = "";
};

function listen() {
  const q = query(collection(db, "mesajlar"), orderBy("zaman"));
  onSnapshot(q, snap => {
    const box = document.getElementById("messages");
    box.innerHTML = "";
    snap.forEach(doc => {
      const d = doc.data();
      const div = document.createElement("div");
      div.className = "msg" + (d.gonderen === user ? " me" : "");
      div.textContent = d.gonderen + ": " + d.metin;
      box.appendChild(div);
    });
    box.scrollTop = box.scrollHeight;
  });
}
</script>

</body>
</html>