<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>InstFatih</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  background:#000;
  color:#fff;
  font-family:Arial, sans-serif;
}

/* TOP BAR */
.topbar{
  padding:15px;
  text-align:center;
  font-size:20px;
  font-weight:bold;
  border-bottom:1px solid #222;
}

/* STORIES */
.stories{
  display:flex;
  overflow-x:auto;
  padding:10px;
  gap:12px;
}
.story{
  text-align:center;
}
.story img{
  width:65px;
  height:65px;
  border-radius:50%;
  border:3px solid #ff0055;
}
.story span{
  font-size:12px;
}

/* POST */
.post{
  border-top:1px solid #222;
  padding:10px;
}
.post img{
  width:100%;
  border-radius:8px;
}
.post-actions{
  margin-top:8px;
  font-size:20px;
}
.username{
  font-weight:bold;
  margin-bottom:5px;
}

/* DM */
.dm-box{
  position:fixed;
  bottom:0;
  width:100%;
  background:#111;
  padding:10px;
  display:flex;
}
.dm-box input{
  flex:1;
  padding:10px;
  border-radius:20px;
  border:none;
  outline:none;
}
.dm-box button{
  margin-left:8px;
  padding:10px 15px;
  border:none;
  border-radius:50%;
  background:#0095f6;
  color:#fff;
}
</style>
</head>

<body>

<div class="topbar">InstFatih</div>

<!-- STORIES -->
<div class="stories">
  <div class="story">
    <img src="https://picsum.photos/200?1">
    <span>fatih</span>
  </div>
  <div class="story">
    <img src="https://picsum.photos/200?2">
    <span>alex</span>
  </div>
  <div class="story">
    <img src="https://picsum.photos/200?3">
    <span>emre</span>
  </div>
  <div class="story">
    <img src="https://picsum.photos/200?4">
    <span>zeynep</span>
  </div>
</div>

<!-- POST 1 -->
<div class="post">
  <div class="username">fatih</div>
  <img src="https://picsum.photos/600/600?random=10">
  <div class="post-actions">‚ù§Ô∏è üí¨ ‚úàÔ∏è</div>
</div>

<!-- POST 2 -->
<div class="post">
  <div class="username">alex</div>
  <img src="https://picsum.photos/600/600?random=20">
  <div class="post-actions">‚ù§Ô∏è üí¨ ‚úàÔ∏è</div>
</div>

<!-- DM -->
<div class="dm-box">
  <input type="text" placeholder="Mesaj yaz...">
  <button>‚û§</button>
</div>

<!-- AUTH + CHAT -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, collection, addDoc, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyC4SCzN-hYyr_sTPv7gHdNmdCW8fcQEahc",
  authDomain: "instafatih-28213.firebaseapp.com",
  projectId: "instafatih-28213",
  storageBucket: "instafatih-28213.firebasestorage.app",
  messagingSenderId: "885847505120",
  appId: "1:885847505120:web:06e60cf83d229e84a37885"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// UI
document.body.insertAdjacentHTML("beforeend", `
<div id="authBox" style="position:fixed;inset:0;background:#000;color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999">
  <h2>Giri≈ü / Kayƒ±t</h2>
  <input id="email" placeholder="email" style="margin:5px">
  <input id="pass" type="password" placeholder="≈üifre" style="margin:5px">
  <button id="login">Giri≈ü</button>
  <button id="register">Kayƒ±t Ol</button>
</div>

<div id="chatBox" style="position:fixed;bottom:60px;left:0;right:0;background:#111;color:#fff;padding:10px">
  <div id="messages" style="max-height:200px;overflow:auto"></div>
  <input id="msg" placeholder="Mesaj yaz..." style="width:80%">
  <button id="send">G√∂nder</button>
</div>
`);

document.getElementById("register").onclick = () => {
  createUserWithEmailAndPassword(auth,
    email.value,
    pass.value
  );
};

document.getElementById("login").onclick = () => {
  signInWithEmailAndPassword(auth,
    email.value,
    pass.value
  );
};

onAuthStateChanged(auth, user => {
  if (user) {
    authBox.style.display = "none";

    const q = query(collection(db, "messages"), orderBy("time"));
    onSnapshot(q, snap => {
      messages.innerHTML = "";
      snap.forEach(d => {
        messages.innerHTML += `<div><b>${d.data().user}</b>: ${d.data().text}</div>`;
      });
    });

    send.onclick = async () => {
      if (msg.value.trim() !== "") {
        await addDoc(collection(db, "messages"), {
          text: msg.value,
          user: user.email,
          time: Date.now()
        });
        msg.value = "";
      }
    };
  }
});
</script>
</body>
</html>